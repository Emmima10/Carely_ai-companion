Goal

When a user chats with Carely, detect emergency phrases (e.g., â€œchest painâ€, â€œbreathing troubleâ€). If detected, (1) calmly reassure the user and (2) send an urgent, formatted alert to the caregiver via Telegram Bot API using the caregiverâ€™s chat_id.
Detection
Match any of these (case-insensitive, word-boundary):
["chest pain", "breathing trouble", "shortness of breath", "canâ€™t breathe", "cannot breathe", "difficulty breathing", "severe headache", "fainting", "unconscious", "heart attack", "stroke", "bleeding a lot", "suicidal"]
If matched â†’ set severity = "very_urgent", else manageable.
Debounce: do not send >1 alert within 5 minutes for the same user unless the message contains â€œworseningâ€ or â€œgetting worseâ€.
UI Flow (Chat with Carely)
Show two options when an emergency phrase is detected:
ğŸ”´ Notify Caregiver (very urgent)
ğŸŸ¢ I feel OK (manageable)
Alternative follow-ups: â€œHelp is on the wayâ€ (after notifying) or â€œAre you feeling better?â€
â€œReturn to chatâ€ brings user back to normal conversation.
User Reassurance (immediate)
Before sending the alert:
â€œIâ€™m here with you. Iâ€™m notifying your caregiver now so help can reach you quickly. Try to sit comfortably and focus on slow breaths. Youâ€™re not alone.â€
 
 
Caregiver Telegram Message Format
 
From: Carely (Emergency Alert)

User: {user_full_name}

ğŸ’¬ Reported Symptoms: {matched_phrase}

âš ï¸ Severity: ğŸ”´ Very Urgent
 
Please take immediate action.

Carely has started first-level comfort and monitoring responses for the user.
 
Telegram Delivery
Use Bot Token and Chat ID from secrets, not hardcoded.
TELEGRAM_BOT_TOKEN
TELEGRAM_CHAT_ID
Endpoint: https://api.telegram.org/bot{TOKEN}/sendMessage
Method: POST with chat_id, text, parse_mode="Markdown" (or none).
Security
Store the token/chat_id in Replit Secrets (ğŸ”‘), not in code.
Never log the token or full message text.
 
How to wire your secrets in Replit
Secrets (ğŸ”‘) â†’ add
TELEGRAM_BOT_TOKEN = 7961050870:AAGsEaktsNpVcN3YViV3KqKL7qY4DG90Pz8
TELEGRAM_CHAT_ID = 7200717892
Do not hardcode tokens in the code
 